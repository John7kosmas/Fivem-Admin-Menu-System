--[[
    ~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
    -- Trase#0001, I create and release these things free, please leave me some credit :)
    ~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~=~
]]


Webhooks = {
    Kicks = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Bans = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Offlinebans = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Godmode = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Invisible = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    CustomPed = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    CarSpawned = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Freeze = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    CarWipe = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    PedWipe = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    ObjectWipe = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    SetGroup = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Reports = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Replys = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Revive = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Setjob = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    AddMoney = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    GiveItem = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    StaffChat = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    TPM = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Unban = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Noclip = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    Forceskin = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R',
    PossibleModder = 'https://discord.com/api/webhooks/959530020387291262/YzifPnXxQBB58BuyD7ZOlbBvv3D06BO4v9J-0ZYqvswltb02CUsukYvm4iiPny6IV-9R'
}

Functions = {
    AdaptiveCard = function(card, source, message, message2)
        card = card
        while GetPlayerName(source) ~= nil do
        card.presentCard({
            ["type"] = "AdaptiveCard",
            ["body"] = {
              {
                type = "TextBlock",
                size = "Medium",
                weight = "Bolder",
                text = message
              },
              {
                type = "ColumnSet",
                columns = {
                  {
                    type = "Column",
                    items = {
                      {
                        type = "Image",
                        size = "Small",
                        url = "https://cdn.discordapp.com/attachments/916466658883801178/923482889147023360/ThorAnimatedLogo.gif",
                        selectAction = {
                          type = "Action.OpenUrl",
                          url = "https://discord.gg/trase"
                        }
                      }
                    },
                    width = "auto"
                  },
                  {
                    type = "Column",
                    items = {
                      {
                        type = "TextBlock",
                        text = "Twizzy Admin-Menu",
                        wrap = true,
                        fontType = "Default",
                        weight = "Bolder"
                      },
                      {
                        type = "TextBlock",
                        spacing = "None",
                        text = "https://discord.gg/trase",
                        wrap = true,
                        isSubtle = true
                      }
                    },
                    width = "stretch"
                  }
                }
              },
              {
                type = "TextBlock",
                text = message2,
                wrap = true
              }
            },
            ["$schema"] = "http://adaptivecards.io/schemas/adaptive-card.json",
            ["version"] = "1.3"
          })
          if GetPlayerName(source) == nil then
            break;
          end
          Wait(1000)
        end
    end
}

ThorAM = {
    Website = 'https://trase.dev/',
    Logo = 'https://cdn.discordapp.com/attachments/824056559562522634/924846887369060413/ThorAnimatedLogo.gif',
    Color = '65793'
}

CreateThread(function()
    local resourceName = GetCurrentResourceName()
    print([[^4
     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó
     ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë
        ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë
        ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë
        ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë
        ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù
  Thanks for purchasing Thor Admin-Menu
  For any support join ^2Discord.gg/trase
    ]])
end)

hasForceskin = nil;
hasOpenMenu = nil
hasGodmode = nil
hasFullHealth = nil
hasFullArmor = nil
hasSpawnWeapon = nil
hasSpawnVehicle = nil
hasInvisible = nil
hasNoclip = nil
hasCustomPed = nil
hasSelfOptions = nil
hasFreeze = nil
hasSpectate = nil
hasSlap = nil
hasHeal = nil
hasGotoPlayer = nil
hasBringPlayer = nil
hasGiveCar = nil
hasGiveWeapon = nil
hasPlayerOptions = nil
hasClearChat = nil;
hasteleportCoords = nil
hasdisplayCoords = nil
hasIdGun = nil
hadDeveloperTools = nil
hasKick = nil
hasBan = nil
hasVehicleoptions = nil
hasSpawnvehicle = nil
hasFixVehicle = nil
hasCleanVehicle = nil
hasDeleteVehicle = nil
hasFlipVehicle = nil
hasESXRevive = nil
hasESXGiveItem = nil
hasESXAddMoney = nil
hasESXAddBank = nil
hasESXAddDirty = nil
hasESXSetJob = nil
hasPedWipe = nil;
hasCarWipe = nil;
hasObjectWipe = nil;
hasViewMoney = nil;
hasSetGroup = nil;
hasReviveAll = nil;
hasReports = nil;
hasStaffChat = nil;
hasTPM = nil;
hasScreenshot = nil;
hasCustomLicensePlate = nil;

RegisterNetEvent('thor_adminmenu:server:getConfig')
AddEventHandler('thor_adminmenu:server:getConfig', function()
    local menuKeyEnabled = TAM.Menu.OpenKey.Enabled 
    local openKey = TAM.Menu.OpenKey.Key
    local openCommand = TAM.Menu.Command.Enabled
    local openCommandCmd = TAM.Menu.Command.Command
    local maxHealth = TAM.Player.MaxHealth
    local maxArmor = TAM.Player.MaxArmor
    local enabledESX = TAM.ESX.Enabled
    local ESXMainEvent = TAM.ESX.Events.Main
    local ESXJobEvent = TAM.ESX.Events.Job
    local ESXReviveEvent = TAM.ESX.Events.Revive
    local replyCommandEnabled = TAM.Reply.Enabled
    local reportCommandEnabled = TAM.Reports.Enabled
    local commandReply = TAM.Reply.Command
    local commandReport = TAM.Reports.Command
    local commandsEnabled = TAM.Commands.Enabled
    local nclipSpeed = TAM.Noclip.Speed
    local screenshotEnabled = TAM.Screenshot.Enabled
    local chatclearEvent = TAM.ClearChat.Event

    TriggerClientEvent('thor_adminmenu:client:getConfig', source, menuKeyEnabled, openKey, openCommand, openCommandCmd, maxHealth, maxArmor, enabledESX, ESXMainEvent, ESXJobEvent, ESXReviveEvent, replyCommandEnabled, reportCommandEnabled, commandReply, commandReport, nclipSpeed, screenshotEnabled, chatclearEvent)
end)

RegisterNetEvent('thor_adminmenu:server:getPermissions')
AddEventHandler('thor_adminmenu:server:getPermissions', function()
    if IsPlayerAceAllowed(source, 'thor_admin.openmenu') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasOpenMenu = true
    else
        hasOpenMenu = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.selfoptions') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasSelfOptions = true
    else
        hasSelfOptions = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.godmode') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasGodmode = true
    else
        hasGodmode = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.fullhealth') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasFullHealth = true
    else
        hasFullHealth = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.fullarmor') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasFullArmor = true
    else
        hasFullArmor = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.spawnweapon') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasSpawnWeapon = true
    else
        hasSpawnWeapon = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.spawnvehicle') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasSpawnVehicle = true
    else
        hasSpawnVehicle = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.invisible') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasInvisible = true
    else
        hasInvisible = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.noclip') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasNoclip = true
    else
        hasNoclip = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.customped') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasCustomPed = true
    else
        hasCustomPed = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.freeze') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasFreeze = true
    else
        hasFreeze = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.spectate') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasSpectate = true
    else
        hasSpectate = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.slap') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasSlap = true
    else
        hasSlap = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.heal') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasHeal = true
    else
        hasHeal = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.goto') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasGotoPlayer = true
    else
        hasGotoPlayer = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.bring') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasBringPlayer = true
    else
        hasBringPlayer = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.spawncar') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasGiveCar = true
    else
        hasGiveCar = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.giveweapon') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasGiveWeapons = true
    else
        hasGiveWeapons = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.playeroptions') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasPlayerOptions = true
    else
        hasPlayerOptions = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.tpc') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasteleportCoords = true
    else
        hasteleportCoords = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.coords') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasdisplayCoords = true
    else
        hasdisplayCoords = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.idGun') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasIdGun = true
    else
        hasIdGun = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.developertools') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hadDeveloperTools = true
    else
        hadDeveloperTools = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.kick') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasKick = true
    else
        hasKick = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.ban') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasBan = true
    else
        hasBan = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.vehicleoptions') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasVehicleoptions = true
    else
        hasVehicleoptions = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.spawnvehicle') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasSpawnvehicle = true
    else
        hasSpawnvehicle = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.fixvehicle') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasFixVehicle = true
    else
        hasFixVehicle = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.cleanvehicle') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasCleanVehicle = true
    else
        hasCleanVehicle = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.deletevehicle') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasDeleteVehicle = true
    else
        hasDeleteVehicle = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.flipvehicle') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasFlipVehicle = true
    else
        hasFlipVehicle = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.esx_revive') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasESXRevive = true
    else
        hasESXRevive = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.esx_giveitem') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasESXGiveItem = true
    else
        hasESXGiveItem = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.esx_add_money') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasESXAddMoney = true
    else
        hasESXAddMoney = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.esx_add_bank') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasESXAddBank = true
    else
        hasESXAddBank = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.esx_add_dirty') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasESXAddDirty = true
    else
        hasESXAddDirty = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.esx_set_job') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasESXSetJob = true
    else
        hasESXSetJob = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.pedwipe') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasPedWipe = true
    else
        hasPedWipe = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.carwipe') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasCarWipe = true
    else
        hasCarWipe = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.objectwipe') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasObjectWipe = true
    else
        hasObjectWipe = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.viewmoney') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasViewMoney = true
    else
        hasViewMoney = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.setgroup') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasSetGroup = true
    else
        hasSetGroup = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.reviveall') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasReviveAll = true
    else
        hasReviveAll = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.reports') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasReports = true
    else
        hasReports = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.staffchat') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasStaffChat = true
    else
        hasStaffChat = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.tpm') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasTPM = true
    else
        hasTPM = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.screenshot') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasScreenshot = true
    else
        hasScreenshot = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.forceskin') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasForceskin = true
    else
        hasForceskin = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.licenseplate') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasCustomLicensePlate = true
    else
        hasCustomLicensePlate = false
    end
    if IsPlayerAceAllowed(source, 'thor_admin.clearchat') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
        hasClearChat = true
    else
        hasClearChat = false
    end

    TriggerClientEvent('thor_adminmenu:client:getPermissions', source, hasOpenMenu, hasSelfOptions, hasGodmode, hasFullHealth, hasFullArmor, hasSpawnWeapon, hasSpawnVehicle, hasInvisible, hasNoclip, hasCustomPed, hasPlayerOptions, hasFreeze, hasSpectate, hasSlap, hasHeal, hasGotoPlayer, hasBringPlayer, hasGiveWeapons, hasteleportCoords, hasdisplayCoords, hasIdGun, hadDeveloperTools, hasKick, hasBan, hasVehicleoptions, hasSpawnvehicle, hasFixVehicle, hasCleanVehicle, hasDeleteVehicle, hasFlipVehicle, hasESXRevive, hasESXGiveItem, hasESXAddMoney, hasESXAddBank, hasESXAddDirty, hasESXSetJob, hasCarWipe, hasPedWipe, hasObjectWipe, hasViewMoney, hasSetGroup, hasReviveAll, hasTPM, hasScreenshot, hasForceskin, hasCustomLicensePlate, hasClearChat)
end)

RegisterServerEvent("thor_adminmenu:server:getPlayers", function()
    local playerList = {}
    local players = GetPlayers()
    for i, player in pairs(players) do
        table.insert(playerList, {['id'] = tonumber(player), ['name'] = GetPlayerName(player)})
    end
    TriggerClientEvent("thor_adminmenu:client:getPlayers", source, playerList)
    TriggerClientEvent("thor_adminmenu:client:getDisconnectedPlayers", source, DisconnectedPlayers)
end)

RegisterNetEvent('thor_adminmenu:server:add_weapon')
AddEventHandler('thor_adminmenu:server:add_weapon', function(weapon, ammo)
    local src = source;
    local ped = GetPlayerPed(src)
    local name = GetPlayerName(src)
    local coords = GetEntityCoords(ped, true)
    local x,y,z = table.unpack(coords)
    GiveWeaponToPed(ped, weapon, 999, false, true)
end)

RegisterNetEvent('thor_adminmenu:server:kick_player')
AddEventHandler('thor_adminmenu:server:kick_player', function(player, reason)
    local staffName = GetPlayerName(source)
    thor_adminmenu_discordlog_target(source, player, Webhooks.Kicks, 'Player was kicked for, ``'..reason..'``', 'Player Kicked')
    if TAM.Webhooks.Kicks.Enabled then
        thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.Kicks.Webhook, 'Player was kicked for, ``'..reason..'``', 'Player Kicked')
    end
    DropPlayer(player, '~=~=~=~=~=~=~=~=~\nüî® Thor Admin-Menu üî®\n~=~=~=~=~=~=~=~=~\nüí• ' ..TAM.Language['Kicked'].title.. "\nüìú Reason: " ..reason.. "\nüöß Additional Information: " ..TAM.Language['Kicked'].text.. "\nüìÖ Kick Date: " ..(os.date("%B %d, %Y at %I:%M %p")..'\n~=~=~=~=~=~=~=~=~'))
end)

RegisterNetEvent('thor_adminmenu:server:ban_player')
AddEventHandler('thor_adminmenu:server:ban_player', function(player, reason, duration, durationLabel)
    local staffName = GetPlayerName(source)
    thor_adminmenu_discordlog_target(source, player, Webhooks.Bans, 'Player was banned for, ``'..reason..'``, length: ``' ..durationLabel..'``', 'Player Banned')
    if TAM.Webhooks.Bans.Enabled then
        thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.Bans.Webhook, 'Player was banned for, ``'..reason..'``, length: ``' ..durationLabel..'``', 'Player Banned')
    end
    local date = os.date("%B %d, %Y at %I:%M %p")
    local expires = os.time() + duration
    local expireDate = os.date("%B %d, %Y at %I:%M %p", expires)
    
    BanPlayer(player, reason, duration)
    DropPlayer(player, '~=~=~=~=~=~=~=~=~\nüî® Thor Admin-Menu üî®\n~=~=~=~=~=~=~=~=~\nüí• ' ..TAM.Language['Banned'].title.. "\nüìú Reason: " ..reason.. "\n üöß Additional Information: " ..TAM.Language['Banned'].text.. "\nüïê Ban Length: "..durationLabel.."\nüìÖ Ban Date: " ..date.."\nüìÖ Un-Ban Date: "..expireDate)
end)

RegisterNetEvent('thor_adminmenu:server:offline_ban_player')
AddEventHandler('thor_adminmenu:server:offline_ban_player', function(player, reason, duration, steam, license, xbl, ip, discordid, liveid, tokens)
    local staffName = GetPlayerName(source)
    playerId = tonumber(source)
    local name = GetPlayerName(playerId)
    local identifiers = GetPlayerIdentifiers(playerId)
    local targetIdentifiers = GetPlayerIdentifiers(player)
    local steamid = "Not Found"
    local licenseStaff = "Not Found"
    local discord = "Not Found"
    local xblStaff = "Not Found"
    local liveidStaff = "Not Found"
    local ip = "Not Found"

    if name == nil then
        name = "Not Found"
    end

    for k, v in pairs(identifiers) do
        if string.sub(v, 1, string.len("steam:")) == "steam:" then
            steamid = v
        elseif string.sub(v, 1, string.len("license:")) == "license:" then
            licenseStaff = v
        elseif string.sub(v, 1, string.len("xbl:")) == "xbl:" then
            xblStaff = v
        elseif string.sub(v, 1, string.len("ip:")) == "ip:" then
            ip = string.sub(v, 4)
        elseif string.sub(v, 1, string.len("discord:")) == "discord:" then
            discordid = string.sub(v, 9)
            discord = "<@" .. discordid .. ">"
        elseif string.sub(v, 1, string.len("live:")) == "live:" then
            liveidStaff = v
        end
    end

    local discordInfo = {
        ["author"] = {
            ["name"] = "Falcon AdminMenu",
            ["url"] = ThorAM.Website,
            ["icon_url"] = ThorAM.Logo
        },
        ["color"] = ThorAM.Color,
        ["title"] = 'Offline Player Banned',
        ["footer"] = {
            ["text"] = "Trase-Dev | " .. (os.date("%B %d, %Y at %I:%M %p"))
        },
        ["fields"] = {
            {
                ["name"] = "Name",
                ["value"] = name,
                ["inline"] = true
            },
            {
                ["name"] = "Server ID",
                ["value"] = playerId,
                ["inline"] = true
            },
            {
                ["name"] = "Reason",
                ["value"] = 'Staff member offline banned a disconnected player',
                ["inline"] = false
            },
            {
                ["name"] = "Staff Member Identifiers",
                ["value"] = "**Steam Hex:** ".. steamid.."\n**Rockstar Id:** " ..licenseStaff.. "\n**Xbox:** " .. xblStaff .. "\n**Discord: **" .. discord .. "\n**LiveId:** " ..liveidStaff,
                ["inline"] = true
            },
            {
                ["name"] = "Targets Identifiers",
                ["value"] = "**Steam Hex:** "..steam.."\n**Rockstar Id:** " ..license.. "\n**Xbox:** "..xbl.. "\n**Discord: **" ..discordid.. "\n**LiveId:** " .. liveid,
                ["inline"] = true
            },
        }
    }

    PerformHttpRequest(Webhooks.Offlinebans, function(err, text, headers) end, 'POST', json.encode({ username = 'Trase-Dev', avatar_url = ThorAM.Logo, embeds = { discordInfo } }), { ['Content-Type'] = 'application/json' })
    if TAM.Webhooks.Offlinebans.Enabled then
        PerformHttpRequest(TAM.Webhooks.Offlinebans.Webhook, function(err, text, headers) end, 'POST', json.encode({ username = 'Trase-Dev', avatar_url = ThorAM.Logo, embeds = { discordInfo } }), { ['Content-Type'] = 'application/json' })
    end
    BanPlayer2(source, reason, duration, steam, license, xbl, ip, discordid, liveid, tokens)
end)

DisconnectedPlayers = {}
AddEventHandler('playerDropped', function(reason)
    local steamid  = ""
    local license  = ""
    local discord  = ""
    local xbl      = ""
    local liveid   = ""
    local ip       = ""

    for k,v in pairs(GetPlayerIdentifiers(source))do
        if string.sub(v, 1, string.len("steam:")) == "steam:" then
            steamid = v
        elseif string.sub(v, 1, string.len("license:")) == "license:" then
            license = v
        elseif string.sub(v, 1, string.len("xbl:")) == "xbl:" then
            xbl  = v
        elseif string.sub(v, 1, string.len("ip:")) == "ip:" then
            ip = v
        elseif string.sub(v, 1, string.len("discord:")) == "discord:" then
            discord = v
        elseif string.sub(v, 1, string.len("live:")) == "live:" then
            liveid = v
        end 
    end

    tokens = {}
    for i=0,GetNumPlayerTokens(source) do
        table.insert(tokens, GetPlayerToken(source, i))
    end

    local player = {
        ['id'] = source, 
        ['license'] = license, 
        ['steam'] = steamid, 
        ['live'] = liveid, 
        ['xbl'] = xbl, 
        ['discord'] = discord, 
        ['ip'] = ip, 
        ['tokens'] = tokens,
        ['name'] = GetPlayerName(source), 
        ['reason'] = reason, 
        ['timegone'] = 180000
    }
    table.insert(DisconnectedPlayers, player)
end)

RegisterNetEvent('thor_adminmenu:server:add_weapon_target')
AddEventHandler('thor_adminmenu:server:add_weapon_target', function(target, weapon, ammo)
    local ped = GetPlayerPed(target)
    local name = GetPlayerName(target)
    local coords = GetEntityCoords(ped, true)
    local x,y,z = table.unpack(coords)
    GiveWeaponToPed(ped, weapon, 999, false, true)
end)

RegisterNetEvent('thor_adminmenu:server:spectatePlayer')
AddEventHandler('thor_adminmenu:server:spectatePlayer', function(target)
    TriggerClientEvent('thor_adminmenu:client:spectatePlayer', source, GetPlayerPed(target))
end)

RegisterNetEvent('thor_adminmenu:server:clear_loadout')
AddEventHandler('thor_adminmenu:server:clear_loadout', function()
    local src = source;
    local ped = GetPlayerPed(src)
    RemoveAllPedWeapons(ped, false)
end)

RegisterNetEvent('thor_adminmenu:server:freeze_player_logs')
AddEventHandler('thor_adminmenu:server:freeze_player_logs', function(target)
    thor_adminmenu_discordlog_target(source, target, Webhooks.Freeze, 'Staff member froze another player', 'Player Frozen')
    if TAM.Webhooks.Freeze.Enabled then
        thor_adminmenu_discordlog_target(source, target, TAM.Webhooks.Freeze.Webhook, 'Staff member froze another player', 'Player Frozen')
    end
end)

RegisterNetEvent('thor_adminmenu:server:freeze_player')
AddEventHandler('thor_adminmenu:server:freeze_player', function(target)
    local targetPed = GetPlayerPed(target)
    TriggerClientEvent('thor_adminmenu:client:Freeze_Player', target)
end)


if TAM.ESX.Enabled then
    ESX = nil
    TriggerEvent(TAM.ESX.Events.Main, function(obj) ESX = obj end)

    RegisterNetEvent("thor_adminmenu:server:revive_self")
    AddEventHandler('thor_adminmenu:server:revive_self', function(player)
        local src = source
        TriggerClientEvent(TAM.ESX.Events.Revive, src)
        thor_adminmenu_discordlog(src, Webhooks.Revive, 'Staff member revived them-self', 'Self revive')
        if TAM.Webhooks.ESXLogs.Revive.Enabled then
            thor_adminmenu_discordlog(src, TAM.Webhooks.ESXLogs.Revive.Webhook, 'Staff member revived them-self', 'Revived')
        end
    end)

    if TAM.ConsoleCmds.ReviveAll.Enabled then
        RegisterCommand(TAM.ConsoleCmds.ReviveAll.Command, function(src)
            if src == 0 then
                TriggerClientEvent(TAM.ESX.Events.Revive, -1)
                thor_adminmenu_discordlog_console(Webhooks.ReviveAll, 'Console revived all in-game players', 'Revived All')
                if TAM.ConsoleCmds.ReviveAll.Log.Enabled then
                    thor_adminmenu_discordlog_console(TAM.ConsoleCmds.ReviveAll.Log.Webhook, 'Console revived all in-game players', 'Revived All')
                end
            end
        end, true)
    end

    RegisterNetEvent("thor_adminmenu:server:revive_all")
    AddEventHandler('thor_adminmenu:server:revive_all', function()
        local src = source
        TriggerClientEvent(TAM.ESX.Events.Revive, -1)
        thor_adminmenu_discordlog(src, Webhooks.Revive, 'Staff member revived **everyone**', 'Server Revive')
        if TAM.Webhooks.ESXLogs.Revive.Enabled then
            thor_adminmenu_discordlog(src, TAM.Webhooks.ESXLogs.Revive.Webhook, 'Staff member revived the server', 'Revived')
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:skin_menu")
    AddEventHandler('thor_adminmenu:server:skin_menu', function(target)
        if target == 'self' then
            target = source
        else
            target = target 
        end
        TriggerClientEvent(TAM.ESX.Events.Skin, target)
        if target == 'self' then
            thor_adminmenu_discordlog(source, Webhooks.Forceskin, 'Staff member gave thereself a skin menu', 'Skin Menu')
        else
            thor_adminmenu_discordlog_target(source, target, Webhooks.Forceskin, 'Staff member gave a player a skin menu', 'Skin Menu')
        end
        if TAM.Webhooks.ESXLogs.Forceskin.Enabled then
            if target == 'self' then
                thor_adminmenu_discordlog(source, TAM.Webhooks.ESXLogs.Forceskin.Webhook, 'Staff member gave thereself a skin menu', 'Skin Menu')
            else
                thor_adminmenu_discordlog_target(source, target, TAM.Webhooks.ESXLogs.Forceskin.Webhook, 'Staff member gave a player a skin menu', 'Skin Menu')
            end
        end
    end)

    RegisterNetEvent('thor_adminmenu:server:esx_getPlayerMoney')
    AddEventHandler('thor_adminmenu:server:esx_getPlayerMoney', function(player)
        local xPlayer = ESX.GetPlayerFromId(player)
        if (xPlayer) then
            money = xPlayer.getMoney()
            bank = xPlayer.getAccount('bank')
            if money then
                if bank then
                    TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~g~Player\'s ~b~money:~y~ $' ..money..'~s~, ~g~Player\'s ~b~bank: ~y~$'..bank.money)
                else
                    TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~r~Couldn\'t get players bank')
                end
            else
                TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~r~Couldn\'t get players money')
            end
        end
    end)    

    RegisterNetEvent("thor_adminmenu:server:esx_give_item")
    AddEventHandler('thor_adminmenu:server:esx_give_item', function(itemName, amount)
        local src = source
        local falconPlayer = ESX.GetPlayerFromId(src)
        falconPlayer.addInventoryItem(itemName, amount)
        TriggerClientEvent('thor_adminmenu:client:sendNotification', src, '~g~Successfully gave you ' ..amount..'x ' ..itemName)
        thor_adminmenu_discordlog(source, Webhooks.GiveItem, 'Staff member spawned in an item, item: ``'..itemName..'``, amount: ``' ..amount..'``', 'Item Spawned')
        if TAM.Webhooks.ESXLogs.GiveItem.Enabled then
            thor_adminmenu_discordlog(source, TAM.Webhooks.ESXLogs.GiveItem.Webhook, 'Staff member spawned in an item, item: ``'..itemName..'``, amount: ``' ..amount..'``', 'Item Spawned')
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_add_money")
    AddEventHandler('thor_adminmenu:server:esx_add_money', function(amount)
        if IsPlayerAceAllowed(source, 'thor_admin.esx_add_money') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
            local src = source
            local falconPlayer = ESX.GetPlayerFromId(src)
            falconPlayer.addMoney(amount)
            TriggerClientEvent('thor_adminmenu:client:sendNotification', src, '~g~Successfully added you $' ..amount..' to your money')
            thor_adminmenu_discordlog(source, Webhooks.AddMoney, 'Staff member spawned in money, amount: ``' ..amount..'``', 'Money Spawned')
            if TAM.Webhooks.ESXLogs.AddMoney.Enabled then
                thor_adminmenu_discordlog(source, TAM.Webhooks.ESXLogs.AddMoney.Webhook, 'Staff member spawned in money, amount: ``' ..amount..'``', 'Money Spawned')
            end
        else 
            if TAM.PossibleModders.Enabled then
                if TAM.PossibleModders.Punishment == 'ban' then
                    BanPlayer(source, 'Possible Modder, attempted to add money without being ace allowed', 10444633200)
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was banned, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was banned, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    end
                elseif Tam.PossibleModders.Punishment == 'kick' then
                    TriggerEvent('thor_adminmenu:server:kick_player', source, 'Possible Modder, attempted to add money without being ace allowed')
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was kicked, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was kicked, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    end
                end
            end
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_add_bank")
    AddEventHandler('thor_adminmenu:server:esx_add_bank', function(amount)
        if IsPlayerAceAllowed(source, 'thor_admin.esx_add_bank') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
            local src = source
            local falconPlayer = ESX.GetPlayerFromId(src)
            falconPlayer.addAccountMoney('bank', tonumber(amount))
            TriggerClientEvent('thor_adminmenu:client:sendNotification', src, '~g~Successfully added you $' ..amount..' to your ~b~bank')
            thor_adminmenu_discordlog(source, Webhooks.AddMoney, 'Staff member spawned in money to there bank, amount: ``' ..amount..'``', 'Money Spawned')
            if TAM.Webhooks.ESXLogs.AddMoney.Enabled then
                thor_adminmenu_discordlog(source, TAM.Webhooks.ESXLogs.AddMoney.Webhook, 'Staff member spawned in money to there bank, amount: ``' ..amount..'``', 'Money Spawned')
            end
        else 
            if TAM.PossibleModders.Enabled then
                if TAM.PossibleModders.Punishment == 'ban' then
                    BanPlayer(source, 'Possible Modder, attempted to add money without being ace allowed', 10444633200)
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was banned, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was banned, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    end
                elseif Tam.PossibleModders.Punishment == 'kick' then
                    TriggerEvent('thor_adminmenu:server:kick_player', source, 'Possible Modder, attempted to add money without being ace allowed')
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was kicked, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was kicked, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    end
                end
            end
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_add_dirty")
    AddEventHandler('thor_adminmenu:server:esx_add_dirty', function(amount)
        if IsPlayerAceAllowed(source, 'thor_admin.esx_add_dirty') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
            local src = source
            local falconPlayer = ESX.GetPlayerFromId(src)
            falconPlayer.addAccountMoney('black_money', tonumber(amount))
            TriggerClientEvent('thor_adminmenu:client:sendNotification', src, '~g~Successfully added you $' ..amount..' to your ~r~dirty~g~ money')
            thor_adminmenu_discordlog(source, Webhooks.AddMoney, 'Staff member spawned in dirty money, amount: ``' ..amount..'``', 'Money Spawned')
            if TAM.Webhooks.ESXLogs.AddMoney.Enabled then
                thor_adminmenu_discordlog(source, TAM.Webhooks.ESXLogs.AddMoney.Webhook, 'Staff member spawned in dirty money, amount: ``' ..amount..'``', 'Money Spawned')
            end
        else 
            if TAM.PossibleModders.Enabled then
                if TAM.PossibleModders.Punishment == 'ban' then
                    BanPlayer(source, 'Possible Modder, attempted to add money without being ace allowed', 10444633200)
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was banned, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was banned, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    end
                elseif Tam.PossibleModders.Punishment == 'kick' then
                    TriggerEvent('thor_adminmenu:server:kick_player', source, 'Possible Modder, attempted to add money without being ace allowed')
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was kicked, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was kicked, reason: ``attempted to add money without being ace allowed``', 'Possible Modder')
                    end
                end
            end
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_set_job")
    AddEventHandler('thor_adminmenu:server:esx_set_job', function(jobName, jobGrade)
        if IsPlayerAceAllowed(source, 'thor_admin.esx_set_job') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
            local src = source
            local playerId = tonumber(src)
            local falconPlayer = ESX.GetPlayerFromId(src)
            falconPlayer.setJob(jobName, jobGrade)
            thor_adminmenu_discordlog(source, Webhooks.Setjob, 'Staff member set there job, job: ``' ..jobName..'``, job grade: ``' ..jobGrade.. '``', 'Job Set')
            if TAM.Webhooks.ESXLogs.SetJob.Enabled then
                thor_adminmenu_discordlog(source, TAM.Webhooks.ESXLogs.SetJob.Webhook, 'Staff member set there job, job: ``' ..jobName..'``, job grade: ``' ..jobGrade.. '``', 'Job Set')
            end
        else 
            if TAM.PossibleModders.Enabled then
                if TAM.PossibleModders.Punishment == 'ban' then
                    BanPlayer(source, 'Possible Modder, attempted to set job without being ace allowed', 10444633200)
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was banned, reason: ``attempted to set job without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was banned, reason: ``attempted to set job without being ace allowed``', 'Possible Modder')
                    end
                elseif Tam.PossibleModders.Punishment == 'kick' then
                    TriggerEvent('thor_adminmenu:server:kick_player', source, 'Possible Modder, attempted to set job without being ace allowed')
                    thor_adminmenu_discordlog(source, Webhooks.PossibleModder, 'Possible modder was kicked, reason: ``attempted to set job without being ace allowed``', 'Possible Modder')
                    if TAM.PossibleModders.Logs.Enabled then 
                        thor_adminmenu_discordlog(source, TAM.PossibleModders.Logs.Webhook, 'Possible modder was kicked, reason: ``attempted to set job without being ace allowed``', 'Possible Modder')
                    end
                end
            end
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_revive_player")
    AddEventHandler('thor_adminmenu:server:esx_revive_player', function(player)
        TriggerClientEvent(TAM.ESX.Events.Revive, player)
        thor_adminmenu_discordlog_target(source, player, Webhooks.Revive, 'Staff member revived another player', 'Player Revived')
        if TAM.Webhooks.ESXLogs.Revive.Enabled then
            thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.ESXLogs.Revive.Webhook, 'Staff member revived another player', 'Player Revived')
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_give_item_player")
    AddEventHandler('thor_adminmenu:server:esx_give_item_player', function(player, itemName, amount)
        local falconPlayer = ESX.GetPlayerFromId(player)
        falconPlayer.addInventoryItem(itemName, amount)
        TriggerClientEvent('thor_adminmenu:client:sendNotification', player, '~g~Successfully gave you ' ..amount..'x ' ..itemName)
        thor_adminmenu_discordlog_target(source, player, Webhooks.GiveItem, 'Staff member spawned an item for another player, item: ``'..itemName..'``, amount: ``x'..amount..'``', 'Item Spawned')
        if TAM.Webhooks.ESXLogs.GiveItem.Enabled then
            thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.ESXLogs.GiveItem.Webhook, 'Staff member spawned an item for another player, item: ``'..itemName..'``, amount: ``x'..amount..'``', 'Item Spawned')
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_add_money_player")
    AddEventHandler('thor_adminmenu:server:esx_add_money_player', function(player, amount)
        local src = source
        local falconPlayer = ESX.GetPlayerFromId(player)
        falconPlayer.addMoney(amount)
        TriggerClientEvent('thor_adminmenu:client:sendNotification', player, '~g~Successfully added you $' ..amount..' to your money')
        thor_adminmenu_discordlog_target(source, player, Webhooks.AddMoney, 'Staff member gave a player money, amount: ``'..amount..'``', 'Money Spawned')
        if TAM.Webhooks.ESXLogs.AddMoney.Enabled then
            thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.ESXLogs.AddMoney.Webhook, 'Staff member gave a player money, amount: ``'..amount..'``', 'Money Spawned')
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_add_bank_player")
    AddEventHandler('thor_adminmenu:server:esx_add_bank_player', function(player, amount)
        local src = source
        local falconPlayer = ESX.GetPlayerFromId(player)
        falconPlayer.addAccountMoney('bank', tonumber(amount))
        TriggerClientEvent('thor_adminmenu:client:sendNotification', player, '~g~Successfully added you $' ..amount..' to your ~b~bank')
        thor_adminmenu_discordlog_target(source, player, Webhooks.AddMoney, 'Staff member gave a player money to there bank, amount: ``'..amount..'``', 'Money Spawned')
        if TAM.Webhooks.ESXLogs.AddMoney.Enabled then
            thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.ESXLogs.AddMoney.Webhook, 'Staff member gave a player money to there bank, amount: ``'..amount..'``', 'Money Spawned')
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_add_dirty_player")
    AddEventHandler('thor_adminmenu:server:esx_add_dirty_player', function(player, amount)
        local src = source
        local falconPlayer = ESX.GetPlayerFromId(player)
        falconPlayer.addAccountMoney('black_money', tonumber(amount))
        TriggerClientEvent('thor_adminmenu:client:sendNotification', player, '~g~Successfully added you $' ..amount..' to your ~r~dirty~g~ money')
        thor_adminmenu_discordlog_target(source, player, Webhooks.AddMoney, 'Staff member gave a player dirty money, amount: ``'..amount..'``', 'Money Spawned')
        if TAM.Webhooks.ESXLogs.AddMoney.Enabled then
            thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.ESXLogs.AddMoney.Webhook, 'Staff member gave a player dirty money, amount: ``'..amount..'``', 'Money Spawned')
        end
    end)

    RegisterNetEvent("thor_adminmenu:server:esx_set_job_player")
    AddEventHandler('thor_adminmenu:server:esx_set_job_player', function(player, jobName, jobGrade)
        local src = source
        local falconPlayer = ESX.GetPlayerFromId(player)
        falconPlayer.setJob(jobName, jobGrade)
        TriggerClientEvent('thor_adminmenu:client:sendNotification', player, '~g~Successfully added you $' ..amount..' to your ~r~dirty~g~ money').
        thor_adminmenu_discordlog_target(source, player, Webhooks.Setjob, 'Staff member set a players job, job: ``'..jobName..'``, Job Grade: ' ..jobGrade..'``', 'Job Set')
        if TAM.Webhooks.ESXLogs.SetJob.Enabled then
            thor_adminmenu_discordlog_target(source, player, TAM.Webhooks.ESXLogs.SetJob.Webhook, 'Staff member set a players job, job: ``'..jobName..'``, Job Grade: ' ..jobGrade..'``', 'Job Set')
        end
    end)

    RegisterNetEvent('trase:server:setgroup')
    AddEventHandler('trase:server:setgroup', function(player, group)
        if player == nil then
            player = source;
        else
            player = player
        end
        if hasSetGroup then
            if (player) then
                TriggerEvent("es:getAllGroups", function(groups)
                    if (group) then
                        TriggerEvent("es:getPlayerFromId", player, function(user)
                            ExecuteCommand('remove_principal identifier.' .. user.getIdentifier() .. " group." .. user.getGroup())
                            TriggerEvent("es:setPlayerData", player, "group", group, function(response, success)
                                TriggerClientEvent('es:setPlayerDecorator', player, 'group', tonumber(group), true)
                                ExecuteCommand('add_principal identifier.' ..user.getIdentifier().. " group."..user.getGroup())
                                thor_adminmenu_discordlog(player, Webhooks.SetGroup, 'Player\'s group was set, group: ``'..group..'``', 'Player Group Set')
                                if TAM.Webhooks.ESXLogs.SetGroup.Enabled then
                                    thor_adminmenu_discordlog(player, TAM.Webhooks.ESXLogs.SetGroup.Webhook, 'Player\'s group was set, group: ``'..group..'``', 'Player Group Set')
                                end
                                
                            end)
                            TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~g~'..GetPlayerName(player).. " has been set as " .. group)
                        end)
                    else
                        TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~r~Incorrect Group.')
                    end
                end)
            else
                TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~r~Player Not Found.')
            end
        else
            TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~r~You do not have permission to do this.')
        end
    end)
end


RegisterNetEvent('thor_adminmenu:server:spectate_player')
AddEventHandler('thor_adminmenu:server:spectate_player', function(target)
    local ped = GetPlayerPed(target)
    TriggerClientEvent('trase:client:spectatePlayer', source, ped)
end)

RegisterNetEvent('thor_adminmenu:server:set_health')
AddEventHandler('thor_adminmenu:server:set_health', function(selectedPlayer, amount)
    TriggerClientEvent('thor_adminmenu:client:set_health', selectedPlayer, amount)
end)

RegisterNetEvent('thor_adminmenu:server:set_armor')
AddEventHandler('thor_adminmenu:server:set_armor', function(selectedPlayer, amount)
    TriggerClientEvent('thor_adminmenu:client:set_armor', selectedPlayer, amount)
end)

RegisterNetEvent('thor_adminmenu:server:goto_player')
AddEventHandler('thor_adminmenu:server:goto_player', function(target)
    local src = source;
    local ped = GetPlayerPed(src)
    local target_ped = GetPlayerPed(target)
    local coords = GetEntityCoords(target_ped, true)
    local x,y,z = table.unpack(coords)
    SetEntityCoords(ped, x,y,z)
end)

RegisterNetEvent('thor_adminmenu:server:teleport_player')
AddEventHandler('thor_adminmenu:server:teleport_player', function(coords)
    local ped = GetPlayerPed(src)
    SetEntityCoords(ped, coords)
end)

RegisterNetEvent('thor_adminmenu:server:bring_player')
AddEventHandler('thor_adminmenu:server:bring_player', function(target)
    local src = source;
    local ped = GetPlayerPed(src)
    local target_ped = GetPlayerPed(target)
    local coords = GetEntityCoords(ped, true)
    local x,y,z = table.unpack(coords)
    SetEntityCoords(target_ped, x,y,z)
end)

RegisterNetEvent('thor_adminmenu:server:create_vehicle')
AddEventHandler('thor_adminmenu:server:create_vehicle', function(car, target)
    local src = source;
    local ped = GetPlayerPed(src)
    local target_ped = GetPlayerPed(target)
    local coords = GetEntityCoords(ped, true)
    local x,y,z = table.unpack(coords)
    TriggerClientEvent('thor_adminmenu:client:create_vehicle', car, target_ped)
end)


if TAM.Reports.Enabled then
    local report_cooldown = TAM.Reports.Cooldown
    RegisterCommand(TAM.Reports.Command, function(source, args, user)
        if report_cooldown == TAM.Reports.Cooldown then
            local playerName = GetPlayerName(source)
            local playerId = tonumber(source)
            local reason = table.concat(args, " ")
            if reason == '' then
                reason = 'No reason specified'
            else
                reason = reason
            end
            TriggerClientEvent('chat:addMessage', source, {
                template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Player Report <br> {1}<br></div>',
                args = { "", 'Player: '..playerName..' (ID: '..playerId..') ^3Reason: ' ..reason}
            })
            if hasReports then
                TriggerClientEvent('chat:addMessage', source, {
                    template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Player Report <br> {1}<br></div>',
                    args = { "", '^1Incoming Report | ^2Player: '..playerName..' (ID: '..playerId..') ^3Reason: ' ..reason}
                })
            end
            thor_adminmenu_discordlog(source, Webhooks.Reports, 'Player made a report, reason: ``' ..reason..'``', 'Report Created')
            if TAM.Reports.Log.Enabled then
                thor_adminmenu_discordlog(source, TAM.Reports.Log.Webhook, 'Player made a report, reason: ``' ..reason..'``', 'Report Created')
            end
            while report_cooldown > 0 do 
                report_cooldown = report_cooldown - 1
                Wait(1000)
            end
            report_cooldown = TAM.Reports.Cooldown
        else 
            TriggerClientEvent('thor_adminmenu:client:sendNotification', source, '~r~You must wait '..report_cooldown..' secound(s) before creating another report!')
        end

    end)
end

if TAM.Reply.Enabled then
    RegisterCommand(TAM.Reply.Command, function(source, args, user)
        local target = args[1]
        if target ~= nil then
            local targetName = GetPlayerName(target)
            local staffName = GetPlayerName(source)
            if targetName ~= nil then
                local message = args[2]
                if message == nil or message == '' then
                    TriggerClientEvent('chat:addMessage', source, {
                        template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Error <br> {1}<br></div>',
                        args = { "", '^1Please give a message to reply to the player.'}
                    })
                else
                    TriggerClientEvent('chat:addMessage', target, {
                        template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Staff Reply <br> {1}<br></div>',
                        args = { "", '^3Staff Member: '..staffName..' (ID: '..source..'), ^2Reply Sent: ' ..message}
                    })
                    TriggerClientEvent('chat:addMessage', source, {
                        template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Reply Sent <br> {1}<br></div>',
                        args = { "", '^3The reply: "'..message..'" was sent to ^2' ..targetName..' (ID: ' ..target..')'}
                    })
                    thor_adminmenu_discordlog_target(source, target, Webhooks.Replys, 'Staff member replied to a user, message: ``'..message..'``', 'Reply Created')
                    if TAM.Reports.Log.Enabled then
                        thor_adminmenu_discordlog_target(source, target, TAM.Reply.Log.Webhook, 'Staff member replied to a user, message: ``'..message..'``', 'Reply Created')
                    end
                end
            else
                TriggerClientEvent('chat:addMessage', source, {
                    template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Error <br> {1}<br></div>',
                    args = { "", '^1Please specify and in-game player id to reply to.'}
                })
            end
        else
            TriggerClientEvent('chat:addMessage', source, {
                template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Error <br> {1}<br></div>',
                args = { "", '^1Please state the player id you would like to reply to.'}
            })
        end
    end)
end

if TAM.Announce.Enabled then
    RegisterCommand(TAM.Announce.Command, function(source, args, user)
        if (source <= 0) then
            if #args == 0 then 
                print('^3[^6ThorAM^3]: ^1Please state a message to announce.'); 
                return; 
            end
            local Message = table.concat(args, " ")
            TriggerClientEvent('chat:addMessage', -1, {
                template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba('..TAM.Announce.RGBA..'); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Announcement <br> {1}<br></div>',
                args = { "", TAM.Announce.TextColor..' ' ..Message}
            })
            thor_adminmenu_discordlog_console(Webhooks.Announce, 'Announcement made through console, message: ``'..Message..'``', 'Announcement Made')
            if TAM.Announce.Log.Enabled then
                thor_adminmenu_discordlog_console(TAM.Announce.Log.Webhook, 'Announcement made through console, message: ``'..Message..'``', 'Announcement Made')
            end
        else
            if IsPlayerAceAllowed(source, 'thor_admin.announce') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
                local Message = table.concat(args, " ")
                TriggerClientEvent('chat:addMessage', -1, {
                    template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba('..TAM.Announce.RGBA..'); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Announcement <br> {1}<br></div>',
                    args = { "", TAM.Announce.TextColor..' ' ..Message}
                })
                thor_adminmenu_discordlog(source, Webhooks.Announce, 'Staff member made an announcment, message: ``'..Message..'``', 'Announcement Made')
                if TAM.Announce.Log.Enabled then
                    thor_adminmenu_discordlog(source, TAM.Announce.Log.Webhook, 'Staff member made an announcment, message: ``'..Message..'``', 'Announcement Made')
                end
            else
                TriggerClientEvent('chat:addMessage', source, {
                    template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Error <br> {1}<br></div>',
                    args = { "", '^1You do not have permission to use this command.'}
                })
            end
        end
    end)
end

function NotAllowed(src)
    TriggerClientEvent('chat:addMessage', src, {
        template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Error <br> {1}<br></div>',
        args = { "", '^1You do not have permission to use this command.'}
    })
end

function Error(src, message)
    TriggerClientEvent('chat:addMessage', src, {
        template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: Error <br> {1}<br></div>',
        args = { "", '^1'..message}
    })
end

function ChatMessage(src, title, message)
    TriggerClientEvent('chat:addMessage', src, {
        template = '<div style="padding: 0.41vw; margin: -0.1vw; background-color: rgba(0, 0, 0, 0.6); width = auto; border-radius: 5px;"><i class="fas fa-hammer"></i> [TwizzyAdmin]: '..title..' <br> {1}<br></div>',
        args = { "", '^1'..message}
    })
end

CreateThread(function()
    if TAM.Commands.Bring.Enabled then 
        RegisterCommand(TAM.Commands.Bring.Command, function(source, args, user)
            if IsPlayerAceAllowed(source, 'thor_admin.bring') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
                local target = args[1]
                local staffName = GetPlayerName(source)
                local targetName = GetPlayerName(target)
                if staffName == targetName then
                    Error(source, 'You cannot bring yourself.^3 /bring [id]')
                else
                    if targetName ~= nil then
                        TriggerClientEvent('thor_adminmenu:client:bringPlayer', source, target)
                        ChatMessage(source, 'Player Brought', '^2Brought '..targetName)
                    else
                        Error(source, 'Player isn\'t in-game, you must use an active player id.^3 /bring [id]')
                    end
                end
            else
                NotAllowed(source)
            end
        end)
    end

    if TAM.Commands.Goto.Enabled then 
        RegisterCommand(TAM.Commands.Goto.Command, function(source, args, user)
            if IsPlayerAceAllowed(source, 'thor_admin.goto') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
                local target = args[1]
                local staffName = GetPlayerName(source)
                local targetName = GetPlayerName(target)
                if staffName == targetName then
                    Error(source, 'You cannot goto yourself.^3 /goto [id]')
                else
                    if targetName ~= nil then
                        TriggerClientEvent('thor_adminmenu:client:gotoPlayer', source, target)
                        ChatMessage(source, 'Went to Player', '^2Teleported to '..targetName)
                    else
                        Error(source, 'Player isn\'t in-game, you must use an active player id.^3 /goto [id]')
                    end
                end
            else
                NotAllowed(source)
            end
        end)
    end

    if TAM.Commands.Freeze.Enabled then 
        local frozen = false;
        RegisterCommand(TAM.Commands.Freeze.Command, function(source, args, user)
            if IsPlayerAceAllowed(source, 'thor_admin.freeze') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
                frozen = not frozen
                freezemsg = nil;
                if (frozen) then
                    freezemsg = 'Froze'
                else
                    freezemsg = 'Un-Froze'
                end
                local target = args[1]
                local staffName = GetPlayerName(source)
                local targetName = GetPlayerName(target)
                if targetName ~= nil then
                    TriggerClientEvent('thor_adminmenu:client:freezePlayer', source, target)
                    ChatMessage(source, 'Player Froze', '^2' ..freezemsg..' '..targetName)
                else
                    Error(source, 'Player isn\'t in-game, you must use an active player id.^3 /freeze [id]')
                end
            else
                NotAllowed(source)
            end
        end)
    end

    if TAM.Commands.Slap.Enabled then 
        RegisterCommand(TAM.Commands.Slap.Command, function(source, args, user)
            if IsPlayerAceAllowed(source, 'thor_admin.slap') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
                local target = args[1]
                local staffName = GetPlayerName(source)
                local targetName = GetPlayerName(target)
                if targetName ~= nil then
                    TriggerClientEvent('thor_adminmenu:client:set_health', target, amount)
                    ChatMessage(source, 'Player Froze', '^2Slapped '..targetName)
                else
                    Error(source, 'Player isn\'t in-game, you must use an active player id.^3 /slap [id]')
                end
            else
                NotAllowed(source)
            end
        end)
    end

    --[[if TAM.Commands.Spectate.Enabled then 
        local spectating = false;
        RegisterCommand(TAM.Commands.Spectate.Command, function(source, args, user)
            if (hasSpectate) then
                spectating = not spectating
                specmsg = nil;
                if (spectating) then
                    specmsg = 'Spectating'
                else
                    specmsg = 'Stopped Spectating'
                end
                local target = args[1]
                local staffName = GetPlayerName(source)
                local targetName = GetPlayerName(target)
                if staffName == targetName then
                    Error(source, 'You cannot spectate yourself')
                else
                    if targetName ~= nil then
                        TriggerEvent('thor_adminmenu:server:spectate_player', target)
                        ChatMessage(source, 'Player Spectated', '^2'..specmsg..' '..targetName)
                    else
                        Error(source, 'Player isn\'t in-game, you must use an active player id.^3 /slap [id]')
                    end
                end
            else
                NotAllowed(source)
            end
        end)
    end]]--

    if TAM.Commands.Screenshot.Enabled then 
        local spectating = false;
        RegisterCommand(TAM.Commands.Screenshot.Command, function(source, args, user)
            if IsPlayerAceAllowed(source, 'thor_admin.screenshot') or IsPlayerAceAllowed(source, 'thor_admin.alloweverything') then
                local target = args[1]
                local staffName = GetPlayerName(source)
                local targetName = GetPlayerName(target)
                if targetName ~= nil then
                    TriggerEvent('thor_adminmenu:server:screenshotSomeone', target)
                    ChatMessage(source, 'Player Spectated', '^2Player '..targetName..' screenshotted')
                else
                    Error(source, 'Player isn\'t in-game, you must use an active player id.^3 /screenshot [id]')
                end
            else
                NotAllowed(source)
            end
        end)
    end
end)


RegisterNetEvent('thor_adminmenu:server:getScreenshot')
AddEventHandler('thor_adminmenu:server:getScreenshot', function()
    local screenshotEnabled = TAM.Screenshot.Enabled
    local screenshotResource = TAM.Screenshot.Resource

    TriggerClientEvent('thor_adminmenu:client:getScreenshot', -1, screenshotEnabled, screenshotResource)
end)